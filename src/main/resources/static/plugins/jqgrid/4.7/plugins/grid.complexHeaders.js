(function(a){a.jgrid.extend({setComplexHeaders:function(b){b=a.extend({complexHeaders:{defaultStyle:true,threeLevel:[],twoLevel:[]}},b||{});return this.each(function(){var l=b.complexHeaders,j=l.threeLevel,g=l.twoLevel;if(j.length===0||g.length===0){return}this.p.complexHeader=b;var K=this,p=l.defaultStyle===undefined?true:l.defaultStyle,G,E,n,J,k,d,F,x,M,u,c,C,r=0,H=0,A=false,B,v,w,f,y=K.p.colModel,D=y.length,t=K.grid.headers,h=a("table.ui-jqgrid-htable",K.grid.hDiv),m=h.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header"),e=h.children("thead"),s,q,o=h.find(".jqg-first-row-header");if(o[0]===undefined){o=a("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto")}else{o.empty()}var z,I=function(Q,O){var N=0,P=O.length;for(;N<P;N++){if(O[N]&&O[N].startColumnName===Q){return N}}return -1};a(K).prepend(e);n=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-third-row-header");J=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-four-row-header");for(G=0;G<D;G++){d=t[G].el;F=a(d);E=y[G];x={height:"0px",width:t[G].width+"px",display:(E.hidden?"none":"")};a("<th>",{role:"gridcell"}).css(x).addClass("ui-first-th-"+K.p.direction).appendTo(o);d.style.width="";c=I(E.name,j);if(c>=0){B=j[c];v=parseInt(B.numberOfColumns,10);w=B.titleText;for(f=0,M=0;M<v&&(G+M<D);M++){if(!y[G+M].hidden){f++}}k=a("<th>").attr({role:"columnheader",noWrap:true}).addClass("ui-state-default ui-th-column-header ui-th-"+K.p.direction).css({height:"22px","border-top":"0px none",overflow:"hidden"}).html(w);if(f>0){k.attr("colspan",String(f))}if(K.p.headertitles){k.attr("title",k.text())}if(f===0){k.hide()}F.before(k);r=v;if(p===false){A=false;for(var L=0;L<r&&(L+G<D);L++){u=I(y[L+G].name,g);if(u>=0){B=g[u];v=parseInt(B.numberOfColumns,10);for(M=0;M<v&&(L+G+M<D);M++){if(!y[L+G+M].hidden){A=true;break}}if(A===true){break}}}}}C=I(E.name,g);if(r>0&&C>=0){B=g[C];v=parseInt(B.numberOfColumns,10);w=B.titleText;for(f=0,M=0;M<v&&(G+M<D);M++){if(!y[G+M].hidden){f++}}k=a("<th>").attr({role:"columnheader",noWrap:true}).addClass("ui-state-default ui-th-column-header ui-th-"+K.p.direction).css({height:"22px","border-top":"0px none",overflow:"hidden"}).html(w);if(f>0){k.attr("colspan",String(f))}if(K.p.headertitles){k.attr("title",k.text())}if(f===0){k.hide()}n.append(k);H=v}if(r===0){F.attr("rowspan","3");H=0;continue}if(r>0&&H===0){if(p){F.attr("rowspan","2");n.append(d)}else{if(A){F.attr("rowspan","2");n.append(d)}else{k.attr("rowspan","2");J.append(d)}}r--;continue}if(r>0&&H>0){J.append(d);r--;H--}}s=a(K).children("thead");s.prepend(o);n.insertAfter(m);J.insertAfter(n);h.append(s);h.find("span.ui-jqgrid-resize").each(function(){var i=a(this).parent();if(i.is(":visible")){this.style.cssText="height: "+(i.height())+"px !important; cursor: col-resize;"}});h.find("div.ui-jqgrid-sortable").each(function(){var i=a(this),N=i.parent();if(N.is(":visible")&&N.is(":has(span.ui-jqgrid-resize)")){i.css("top",(N.height()-i.outerHeight())/2+"px")}});z=s.find("tr.jqg-first-row-header");a(K).bind("jqGridResizeStop.setGroupHeaders",function(O,N,i){z.find("th").eq(i).width(N)})})},createFrozenHtable:function(e,g){var P=this[0],I=P.p.complexHeader,m=I.complexHeaders,q=m.defaultStyle,k=m.threeLevel,j=m.twoLevel,H=P.p.id,A=P.p.colModel,F=e+1,t=P.grid.headers,r=0,L=0,C=false,K,G,z,d,J,y,B,R,l,D,u,b,E,v,w,h,c=P.grid.fhDiv.height(),M=a("<table class='ui-jqgrid-htable' style='width:1px;height:"+c+"px' role='grid' aria-labelledby='gbox_"+H+"' cellspacing='0' cellpadding='0' border='0'></table>"),f=a("<thead></thead>"),p=a("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"),n=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-second-row-header"),o=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-third-row-header"),O=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-four-row-header"),N=function(V,T){var S=0,U=T.length;for(;S<U;S++){if(T[S]&&T[S].startColumnName===V){return S}}return -1};for(K=0;K<F;K++){G=A[K];y=G.name;J=a("#"+H+"_"+y,g);z={height:"0px",width:t[K].width+"px",display:(G.hidden?"none":"")};a("<th>",{role:"gridcell"}).css(z).addClass("ui-first-th-"+P.p.direction).appendTo(p);b=N(G.name,k);if(b>=0){D=k[b];v=parseInt(D.numberOfColumns,10);if(v+K-1>e){v=e-K+1}w=D.titleText;for(h=0,R=0;R<v&&(K+R<F);R++){if(!A[K+R].hidden){h++}}l=a("<th>").attr({role:"columnheader",noWrap:true}).addClass("ui-state-default ui-th-column-header ui-th-"+P.p.direction).css({height:"22px","border-top":"0px none",overflow:"hidden"}).html(w);if(h>0){l.attr("colspan",String(h))}if(P.p.headertitles){l.attr("title",l.text())}if(h===0){l.hide()}l.appendTo(n);r=v;if(q===false){C=false;for(var Q=0;Q<r&&(Q+K<F);Q++){u=N(A[Q+K].name,j);if(u>=0){D=j[u];v=parseInt(D.numberOfColumns,10);if(v+Q+K-1>e){v=e-(Q+K)+1}for(R=0;R<v&&(Q+K+R<F);R++){if(!A[Q+K+R].hidden){C=true;break}}}if(C===true){break}}}}E=N(G.name,j);if(r>0&&E>=0){D=j[E];v=parseInt(D.numberOfColumns,10);if(v+K-1>e){v=e-K+1}w=D.titleText;for(h=0,R=0;R<v&&(K+R<F);R++){if(!A[K+R].hidden){h++}}l=a("<th>").attr({role:"columnheader",noWrap:true}).addClass("ui-state-default ui-th-column-header ui-th-"+P.p.direction).css({height:"22px","border-top":"0px none",overflow:"hidden"}).html(w);if(h>0){l.attr("colspan",String(h))}if(P.p.headertitles){l.attr("title",l.text())}if(h===0){l.hide()}l.appendTo(o);L=v}if(r===0){J.attr("rowspan","3");J.appendTo(n);L=0;continue}if(r>0&&L===0){if(q){J.attr("rowspan","2");J.appendTo(o)}else{if(C){J.attr("rowspan","2");J.appendTo(o)}else{l.attr("rowspan","2");J.appendTo(O)}}r--;continue}if(r>0&&L>0){J.appendTo(O);r--;L--}}var x=o.children().length,s=O.children().length;if(x===0&&s===0){n.height(c)}if(q){if(x>0&&s===0){o.height(c-23)}}else{if(x===0&&s>0){n.height(c-23);n.find("th").each(function(){var i=a(this).attr("rowspan");if(i){a(this).attr("rowspan",String(parseInt(i,10)-1))}})}}p.appendTo(f);n.appendTo(f);x&&o.appendTo(f);s&&O.appendTo(f);f.appendTo(M);return M}})})(jQuery);